# 毕业设计任务书：计算机视觉任务管理平台

> 版本：v3.2  
> 作者：小明（学生）/ 指导：陶自为  
> 日期：2025-12-12

---

## 一、项目概述

本项目旨在设计并实现一个面向深度学习计算机视觉任务的一站式管理平台，提供从 **数据集管理（含在线数据增强与预览）→ 模型构建（卡片式拖拽并自动生成 PyTorch 代码）→ 训练管理（内置训练可视化面板）→ 推理预览** 的完整工作流。平台采用单用户登录（保存基础配置）并以易扩展、易演示为目标，便于毕业答辩演示与后续功能扩展。

---

## 二、项目目标与交付物

### 2.1 目标
- 提供自动识别常见数据集格式（YOLO、COCO、VOC、文件夹分类等）。
- 支持在线数据增强并能实时预览增强效果。
- 提供卡片式可视化模型构建器，支持拖拽、连线、参数配置、连接合法性校验和自动生成 PyTorch 代码。
- 提供可配置的训练入口并配套内置训练监控面板（loss、mAP、LR、训练时间等），支持 checkpoint 管理与断点续训。
- 提供图像/批量推理预览与基础性能测试（FPS）。
- 单用户登录、保存基础配置（如常用超参、默认数据集路径、模型模板等）。

### 2.2 交付物
- 系统设计说明书（含数据库设计、API 设计、前端页面/组件清单）。
- 可运行的最小可行产品（MVP）：前后端代码、部署脚本、示例数据集与说明文档。
- 测试报告、使用手册与演示脚本（用于答辩）。

---

## 三、功能需求（详细）

### 3.1 数据集管理模块
- **自动识别格式**：扫描并识别 YOLO、COCO、VOC、文件夹类结构；生成统一元信息（DatasetMeta），包含：样本数量、类别列表、每类样本数、图像尺寸分布等。
- **原图与标注预览**：显示原图；标注层（bbox、polygon、segmentation mask）开关；支持缩放、平移与上下翻页。
- **在线数据增强**：支持常见增强操作（翻转、旋转、缩放、裁剪、HSV、亮度对比、Mosaic、MixUp等）；增强可视化预览（随机/确定种子模式，支持对比视图）。
- **数据统计与异常检测**：类别不平衡提示、空标注/极小 bbox 检测、长宽比异常样本列出。
- **数据索引与缓存**：缩略图缓存、按需加载（lazy load），支持对大规模数据集的高效预览。


### 3.2 模型构建模块
- **卡片式节点库**：算子类（Conv2d、BN、ReLU、Linear、Pooling 等）、结构块（ResidualBlock、DenseBlock、InceptionBlock）、功能类（Concat、Add、Upsample）、输入/输出 Head（Classification/Detection/Segmentation）。
- **可视化编辑**：拖拽新增卡片、连线建立数据流、节点属性面板可修改参数（核大小、stride、channels、激活函数等）。
- **连通性与合法性校验**：自动校验张量维度（channels/spatial）、未连接端口提示、循环连接检测并提示错误。
- **模板与组合**：内置若干常用模型结构模板（ResNet、UNet、MobileNet、YOLO-like backbone+neck+head），用户可保存自定义组合为模板。
- **自动生成 PyTorch 代码**：将画布结构导出为可运行的 `nn.Module` 源码（包含必要的 import、类定义与 forward 实现）。
- **模型可视化**：生成模型结构图（可导出为图片或 Netron 兼容格式）。


### 3.3 训练管理模块（内置训练监控面板）
- **配置界面**：选择数据集、模型（上传或从构建器选择）、训练参数（epoch、batch size、lr、optimizer、scheduler、weight decay、AMP 开关、保存周期等），以及 checkpoint 存放路径。
- **训练执行**：后端启动训练进程（支持单机单 GPU，若有需要可拓展多 GPU），训练日志通过 WebSocket 或轮询推送到前端。
- **可视化面板**：实时展示 loss（train/val）、指标（mAP/AP/acc）、学习率曲线、训练/验证时延、checkpoint 列表、混淆矩阵、PR 曲线（必要时）。
- **历史实验管理**：记录训练元信息（开始时间、使用数据集版本、模型版本、超参、最终指标、最佳 checkpoint），支持导出训练报告（PDF/Markdown）。
- **断点续训与自动保存**：每 N epoch 自动保存 checkpoint，支持从任意 checkpoint 恢复训练。


### 3.4 推理模块
- **单图/批量推理**：选择模型与图片（上传或从数据集中选取），显示推理结果（bbox、mask、label+score）。
- **性能评估**：FPS 测试、单张推理时延分解（模型推理、后处理）。
- **结果导出**：导出带标注图像与 JSON 格式预测结果。


### 3.5 用户与配置
- **单用户登录**：实现基本鉴权（用户名+密码）；保存用户常用配置（默认数据集路径、常用超参模板、常用模型模板）。
- **配置导入导出**：支持将项目配置或训练配置导出为 JSON 并在后续导入以复现实验。

---

## 四、非功能性需求
- **性能**：支持 10k+ 张图像的索引与预览（依赖缩略图缓存），训练监控延迟 < 2s（WebSocket 下）
- **可维护性**：后端使用 FastAPI，模块化路由与服务层；前端组件化（React/Vue + 组件库）
- **可扩展性**：模型与数据以 JSON/目录为中间表示，便于后期插件化扩展
- **安全性**：单用户环境下基本鉴权与文件权限控制；保存敏感信息时采取加密/哈希。
- **可移植性**：支持 Docker 部署（Dockerfile + docker-compose）。

---

## 五、系统架构设计

### 5.1 总体架构图（文字说明）
- **前端**：单页应用（SPA），路由包括：仪表盘 / 数据集管理 / 模型构建器 / 训练管理 / 推理 / 设置
- **后端**：FastAPI 提供 REST + WebSocket 接口；训练任务以子进程或后台 worker（如 Celery/rq 或自建进程池）运行；文件存储在服务器指定目录（或未来拓展到对象存储）。
- **数据库**：SQLite（项目阶段）或 PostgreSQL（可选），用于保存元数据、实验记录与用户配置。


### 5.2 主要组件说明
- **Dataset Service**：负责数据集扫描、格式识别、生成 DatasetMeta、缩略图生成与增强预览接口（提供在线增强生成预览的样本）。
- **Model Graph Service**：负责画布保存/加载、连通性校验、shape 推断与代码生成。
- **Training Service**：接收训练任务，启动训练进程，负责 checkpoint 管理、日志收集并推送前端。
- **Inference Service**：载入模型权重并提供推理接口（单图/批量）；提供 FPS 测试工具。
- **Auth & Config Service**：用户登录、配置保存、导入导出。

---

## 六、数据库（简要表设计）

> 由于为毕业设计，使用 SQLite 即可，下表仅给出核心表与字段建议。

### tables
- `users`：id, username, password_hash, created_at
- `datasets`：id, name, path, format, num_images, classes(json), meta(json), created_at
- `dataset_versions`：id, dataset_id, version_tag, changes, created_at
- `models`：id, name, graph_json, code_path, template_tag, created_at
- `training_runs`：id, name, model_id, dataset_version_id, hyperparams(json), status, start_time, end_time, best_checkpoint, metrics(json)
- `checkpoints`：id, run_id, path, epoch, metric_value, saved_at
- `inference_jobs`：id, model_id, input_list(json), result_path, status, created_at

---

## 七、API 接口（示例，REST 风格 + WebSocket）

### Auth
- `POST /api/login` — 登录
- `POST /api/logout` — 登出

### Dataset
- `POST /api/datasets/upload` — 上传数据集（或注册已有路径）
- `GET /api/datasets/{id}` — 返回 DatasetMeta
- `GET /api/datasets/{id}/thumb/{img_id}` — 返回缩略图
- `POST /api/datasets/{id}/augment_preview` — 请求增强预览（body 包含增强策略与随机 seed）

### Model
- `POST /api/models` — 保存/更新模型图（graph json）
- `GET /api/models/{id}/code` — 获取自动生成的 PyTorch 代码

### Training
- `POST /api/train/start` — 提交训练任务（返回 run id）
- `POST /api/train/stop` — 停止训练
- `GET /api/train/{run_id}/status` — 查询状态
- `WS /api/train/ws/{run_id}` — 实时训练日志与指标推送

### Inference
- `POST /api/infer` — 提交推理请求（单图或批量）
- `GET /api/infer/{job_id}/result` — 获取推理结果

---

## 八、前端页面与关键组件清单

- 登录页
- 仪表盘（最近实验、模型、数据集）
- 数据集管理页
  - 数据集列表、详情页（原图/标注预览、统计、增强策略面板）
- 模型构建器页面（画布 + 节点库 + 属性面板 + 导出代码）
- 训练管理页面（训练配置、正在运行任务、训练面板/可视化）
- 推理页面（上传/选择图像、选择模型、显示结果）
- 设置页（保存/导出配置、默认路径、模板管理）

---

## 九、实现计划与里程碑（建议进度：总 16 周）

> 可根据你毕业设计实际时间调整。以下为 16 周分配示例。

- **第 1–2 周：需求确认与详细设计**
  - 完成任务书、总体架构与数据库草图
- **第 3–5 周：基础后端与数据集模块**
  - 搭建 FastAPI 项目结构，完成数据集扫描、格式识别、缩略图服务
- **第 6–8 周：前端基础与数据集 UI**
  - 实现数据集预览页、增强策略预览功能
- **第 9–10 周：模型构建器（基础）**
  - 实现画布、节点库、拖拽与属性面板，保存/加载 graph
- **第 11–12 周：模型代码生成与模板**
  - 实现 shape 推断、连接合法性校验、PyTorch 代码导出
- **第 13–14 周：训练模块与监控面板**
  - 实现训练任务调度、WebSocket 实时日志、dashboard
- **第 15 周：推理模块与结果导出**
  - 实现单图/批量推理、FPS 测试
- **第 16 周：测试、优化、文档与答辩准备**
  - 完成测试报告、用户手册、演示脚本

---

## 十、测试方案
- **单元测试**：后端核心服务函数、模型代码生成模块、数据增强函数
- **集成测试**：训练流程（小样本数据）端到端运行；推理端到端验证
- **性能测试**：数据集预览响应、训练日志推送延迟、推理 FPS
- **用户验收测试**：按演示脚本确认交互流程（数据->模型->训练->推理）可复现

---

## 十一、风险与应对
- **训练时间长/资源不足**：使用小样本快速验证流程；使用云 GPU 或服务器（若可用）。
- **模型构建器 shape 推断复杂**：先实现通用场景下的张量形状推断，复杂/动态图案留为手工校正并在 UI 中提示。
- **数据集格式多样导致兼容问题**：采用逐步兼容策略，优先实现 YOLO/COCO/VOC 与文件夹结构，明确不支持的场景并给出规范说明。

---

## 十二、评估标准（用于答辩/验收）
- 功能完整性：能完成数据导入→模型构建→训练→推理的完整流程（演示脚本）。
- 稳定性：训练任务能中断与续训；前端无严重渲染卡顿。
- 可用性：关键功能（增强预览、模型导出、训练可视化）可交互并易用。
- 文档与测试：包含设计文档、使用手册与测试报告。

---

## 十三、资源需求
- 开发语言：Python（后端）、JavaScript/TypeScript（前端）
- 框架/库：FastAPI、PyTorch、React 或 Vue、React Flow（或类似画布库）
- 环境：具有 GPU 的开发机或云主机（至少单卡），Docker
- 参考资料：PyTorch 文档、React Flow 示例、数据集格式规范（COCO/YOLO/VOC）

---

## 十四、后续可选扩展（超出本次任务范围）
- 多用户与权限管理、项目共享
- 插件化市场（第三方数据增强、模型组件插件）
- 多机/分布式训练支持
- 接入模型量化/部署（ONNX/TF Lite/NCNN）

---


## 十五、附录
- 项目关键术语定义：DatasetMeta、Graph JSON、Checkpoint、mAP
- 推荐参考实现/开源项目：YOLOv8 代码库（用于参考数据/训练方式）、Netron（模型可视化参考）、Roboflow（产品形态参考）


---

> 如需我把该任务书进一步拆成每周任务清单（含每日/每周具体开发任务）、或者直接生成数据库建表 SQL、API Swagger 规范、前端关键页面原型 HTML/CSS/React 组件代码，我可以继续为你生成。请选择下一步要我做的内容。

